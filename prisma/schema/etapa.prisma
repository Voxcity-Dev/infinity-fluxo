// ETAPA

enum NodeType {
  INICIO
  DIALOGO
  API
  FIM
}

model Etapas {
  id            String   @id @default(uuid()) @db.Uuid
  tenant_id     String   @db.Uuid
  fluxo_id      String   @db.Uuid
  nome          String   @db.VarChar(50)
  tipo          NodeType
  interacoes_id String?  @db.Uuid
  variavel_id   String?  @db.Uuid
  metadados     Json?    @default("{\"position\": {\"x\": 100, \"y\": 100}}") @db.JsonB
  is_deleted    Boolean  @default(false)
  created_at    DateTime @default(now()) @db.Timestamp(6)
  updated_at    DateTime @updatedAt @db.Timestamp(6)

  // Relações
  fluxo      Fluxo       @relation(fields: [fluxo_id], references: [id])
  interacoes Interacoes? @relation(fields: [interacoes_id], references: [id])
  condicao   Condicao[]

  @@index([tenant_id, fluxo_id, tipo])
  @@map("etapas")
}
